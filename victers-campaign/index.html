	<!DOCTYPE html>
	<html lang="en">
	<head>
	    <meta charset="UTF-8">
	    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	    <title>KITE Victers Campaign Generator</title>
	    
	    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css">
	    
	    <style>
		:root {
		    --primary: #4CAF50;
		    --dark: #006400;
		    --bg: #f4f4f9;
		}

		body {
		    font-family: sans-serif;
		    background-color: var(--bg);
		    margin: 0;
		    padding: 20px;
		    text-align: center;
		    display: flex;
		    flex-direction: column;
		    align-items: center;
		}

		h1 {
		    color: var(--dark);
		    font-size: 1.2rem;
		    margin-bottom: 5px;
		}
		
		.instruction {
		    color: #666;
		    font-size: 0.9rem;
		    margin-bottom: 20px;
		}

		/* --- 1. UPLOAD BUTTON STYLING --- */
		.upload-container {
		    margin-bottom: 20px;
		}

		.btn-upload {
		    background-color: var(--dark);
		    color: white;
		    padding: 12px 30px;
		    border-radius: 50px;
		    font-size: 1rem;
		    font-weight: bold;
		    cursor: pointer;
		    border: none;
		    box-shadow: 0 4px 6px rgba(0,0,0,0.2);
		    display: inline-flex;
		    align-items: center;
		    gap: 10px;
		}

		input[type="file"] { display: none; }

		/* --- 2. EDITOR MODAL (Hidden by default) --- */
		#editorModal {
		    position: fixed;
		    top: 0; left: 0; right: 0; bottom: 0;
		    background: #222;
		    z-index: 1000;
		    display: none; /* Hidden initially */
		    flex-direction: column;
		}

		/* This container holds both the User Image and the Template Overlay */
		.crop-workspace {
		    flex: 1;
		    position: relative;
		    overflow: hidden;
		    background: #000;
		}

		/* The image the user manipulates */
		#imageToEdit {
		    max-width: 100%;
		    display: block;
		}

		/* THE MAGIC: The Template overlay sits ON TOP of the cropper */
		/* pointer-events: none allows you to touch 'through' the template to move the photo behind it */
		.overlay-template {
		    position: absolute;
		    top: 0; left: 0;
		    width: 100%;
		    height: 100%;
		    z-index: 10;
		    pointer-events: none; 
		    background-image: url('template.png'); 
		    background-size: contain;
		    background-position: center;
		    background-repeat: no-repeat;
		    opacity: 0.9; /* Slight transparency to help align, becomes solid on render */
		}

		.editor-controls {
		    padding: 20px;
		    background: #111;
		    display: flex;
		    justify-content: space-between;
		    gap: 15px;
		}

		.btn-cancel { background: #555; color: white; border: none; padding: 12px 20px; border-radius: 8px; font-weight: bold; flex: 1;}
		.btn-save { background: var(--primary); color: white; border: none; padding: 12px 20px; border-radius: 8px; font-weight: bold; flex: 1;}

		/* --- 3. FINAL RESULT STYLING --- */
		#resultContainer {
		    display: none;
		    width: 100%;
		    max-width: 400px;
		    margin-top: 20px;
		}

		#finalCanvas {
		    width: 100%;
		    height: auto;
		    border-radius: 10px;
		    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
		}

		#downloadBtn {
		    display: block;
		    margin-top: 15px;
		    background: #e91e63;
		    color: white;
		    text-decoration: none;
		    padding: 15px;
		    border-radius: 50px;
		    font-weight: bold;
		    text-align: center;
		}

	    </style>
	</head>
	<body>

	    <h1>‡¥ï‡µÜ‡¥±‡µç‡¥±‡µç ‡¥µ‡¥ø‡¥ï‡µç‡¥ü‡µá‡¥¥‡µç‡¥∏‡µç: ‡¥®‡¥Æ‡µç‡¥Æ‡µÅ‡¥ü‡µÜ ‡¥Ö‡¥µ‡¥ï‡¥æ‡¥∂‡¥Ç</h1>
	    <p class="instruction">Create your campaign poster in seconds.</p>

	    <div class="upload-container">
		<label for="fileInput" class="btn-upload">
		    <span>üì∑ Select Photo / ‡¥´‡µã‡¥ü‡µç‡¥ü‡µã ‡¥ö‡µá‡µº‡¥ï‡µç‡¥ï‡¥æ‡¥Ç</span>
		</label>
		<input type="file" id="fileInput" accept="image/*">
	    </div>

	    <div id="resultContainer">
		<canvas id="finalCanvas"></canvas>
		<a id="downloadBtn" download="My_Victers_Poster.png">Download Poster üì•</a>
		<br>
		<button onclick="location.reload()" style="background:none; border:none; color:#666; text-decoration:underline;">Create Another / ‡¥Æ‡¥±‡µç‡¥±‡µä‡¥®‡µç‡¥®‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡¥æ‡¥Ç</button>
	    </div>

	    <div id="editorModal">
		<div class="crop-workspace">
		    <img id="imageToEdit" src="">
		    <div class="overlay-template"></div>
		</div>
		<div class="editor-controls">
		    <button class="btn-cancel" onclick="closeEditor()">Cancel</button>
		    <button class="btn-save" onclick="generateImage()">‚úÖ Done</button>
		</div>
		<div style="color:white; font-size:0.8rem; padding-bottom:10px;">
		    Drag to move ‚Ä¢ Pinch to zoom (‡¥µ‡¥ø‡¥∞‡µΩ ‡¥ï‡µä‡¥£‡µç‡¥ü‡µç ‡¥ï‡µç‡¥∞‡¥Æ‡µÄ‡¥ï‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡¥Ç)
		</div>
	    </div>

	    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
	    <script>
		// DOM Elements
		const fileInput = document.getElementById('fileInput');
		const editorModal = document.getElementById('editorModal');
		const imageToEdit = document.getElementById('imageToEdit');
		const resultContainer = document.getElementById('resultContainer');
		const finalCanvas = document.getElementById('finalCanvas');
		const downloadBtn = document.getElementById('downloadBtn');

		let cropper = null;
		let templateImage = new Image();
		
		// Load template immediately to get its dimensions
		templateImage.src = 'template.png'; 

		// 1. Handle File Upload
		fileInput.addEventListener('change', (e) => {
		    const file = e.target.files[0];
		    if (file) {
		        const reader = new FileReader();
		        reader.onload = (event) => {
		            imageToEdit.src = event.target.result;
		            openEditor();
		        };
		        reader.readAsDataURL(file);
		    }
		});

		// 2. Open Editor & Initialize Cropper
		function openEditor() {
		    editorModal.style.display = 'flex';
		    
		    // Wait slightly for image to load in DOM
		    setTimeout(() => {
		        if(cropper) cropper.destroy();

		        cropper = new Cropper(imageToEdit, {
		            // Make the crop box match the template aspect ratio
		            aspectRatio: templateImage.width / templateImage.height, 
		            viewMode: 0, // Allow moving image freely
		            dragMode: 'move', // Allow dragging image immediately
		            guides: false, // Hide grid
		            center: false, // Hide center indicator
		            background: false, // Hide grid background
		            autoCropArea: 1, // Maximize crop box
		            cropBoxMovable: false, // Lock the box
		            cropBoxResizable: false, // Lock the box size
		            toggleDragModeOnDblclick: false,
		            ready() {
		                // Force the crop box to fill the view so it aligns with overlay
		                this.cropper.setCropBoxData({
		                    left: 0,
		                    top: 0,
		                    width: this.cropper.getContainerData().width,
		                    height: this.cropper.getContainerData().height
		                });
		            }
		        });
		    }, 100);
		}

		// 3. Close Editor
		function closeEditor() {
		    editorModal.style.display = 'none';
		    fileInput.value = ""; // Reset input
		    if(cropper) cropper.destroy();
		}

		// 4. Generate Final Image
		function generateImage() {
		    if (!cropper) return;

		    // Get the cropped version of the user's photo
		    // We use the template's dimensions for high quality
		    const userCanvas = cropper.getCroppedCanvas({
		        width: templateImage.width,
		        height: templateImage.height,
		        imageSmoothingEnabled: true,
		        imageSmoothingQuality: 'high',
		    });

		    if (!userCanvas) return;

		    // Set final canvas size
		    finalCanvas.width = templateImage.width;
		    finalCanvas.height = templateImage.height;
		    const ctx = finalCanvas.getContext('2d');

		    // A. Draw User Photo (Background)
		    ctx.drawImage(userCanvas, 0, 0, finalCanvas.width, finalCanvas.height);

		    // B. Draw Template (Foreground)
		    ctx.drawImage(templateImage, 0, 0, finalCanvas.width, finalCanvas.height);

		    // Show Result
		    editorModal.style.display = 'none';
		    resultContainer.style.display = 'block';
		    
		    // Set Download Link
		    downloadBtn.href = finalCanvas.toDataURL('image/png');
		}
	    </script>
	</body>
	</html>
